# Установка ArchLinux

# Подключение к интернету
ping 8.8.8.8                # Проверка интернета
iwctl
station wlan0 connect SSID

date                                            # Проверка даты
timedatectl set-timezone Asia/Novosibirsk       # Установка часового пояса Новосибирска
    
lsblk                       # Просмотр дисков и разделов

# Разметка диска
cfdisk -z  /dev/nvme0n1     # Редактирование разметки диска
/dev/nvme0n1p1 -- 600M -- EFI 
/dev/nvme0n1p2 -- 40G 	-- /
/dev/nvme0n1p3 -- 425G -- /home
/dev/nvme0n1p4 -- 8GB 	-- Swap

# Форматирование разделов
mkfs.fat -F 32 /dev/sda1
mkfs.btrfs /dev/sda2 -L "Arch"
mkfs.btrfs /dev/sda3 -L "Home"
mkswap /dev/sda4
spawon /dev/sda4

# Примонтирование разделов
mount /dev/sda1 /mnt
mount --mkdir /dev/sda1 /mnt/boot
mount --mkdir /dev/sda2 /mnt/home

# Установка базовых пакетов
pacstrap -K /mnt base base-devel linux linux-firmware git wget yajl amd-ucode sudo nano neovim networkmanager iwd dhcpcd tlp zsh

# Fstab
genfstab -U /mnt >> /mnt/etc/Fstab

# Chroot
arch-chroot /mnt

# Часовой пояс
ln -sf /usr/share/zoneinfo/Asia/Novokuznetsk /etc/localtime
hwclock --systohc

# Локализация
nano /etc/locale.gen :
 en_US.UTF-8
 ru_RU.UTF-8

locale-gen

nano /etc/locale.conf:
LANG=ru_RU.UTF-8

nano /etc/vconsole.conf :
KEYMAP=ru
FONT=cyr-sun16

# Настройка сети
nano /etc/hostname :
ZenBook

nano /etc/hosts :
127.0.0.1	localhost
::1         localhost
127.0.1.1	ZenBook.localdomain	ZenBook

# Пользователь и суперпользователь
useradd -G wheel -s /bin/bash -m NAME

passwd NAME >> PASSWORD -- Пароль для пользователя NAME
passwd >> PASSWORD -- Пароль для суперпользователя

# Установка загрузчика
bootctl --path=boot install
bootctl update

nano /boot/loader/loader.conf :
default arch.conf
timeout 
console-mode max
editor yes

blkid /dev/nvme0n1p2 -- копируем PARTUUID корневого раздела

nano /boot/loader/entries/arch.conf :
title	ArchLinux
linux	/vmlinuz-linux
initrd	/amd-ucode.img
initrd	/initramfs-linux.img
options	root=PARTUUID=0e0d7676-3a9e-d74d-ab6d-f7d3abadd63d rw quiet splash loglevel=3 udev.log_level=3 i8042.probe_defer

mkinitcpio -P

# systemd
systemctl enable NetworkManager.service
systemctl enable fstrim.timer

# tlp
systemctl enable tlp.service
tlp-stat -b

nano /etc/pacman.conf :
 [multilib]
 Include = /etc/pacman.d/mirrorlist

nano /etc/sudoers :
 %wheel      ALL=(ALL:ALL) ALL

# Выход из Chroot
exit

reboot      # Перезагрузка
